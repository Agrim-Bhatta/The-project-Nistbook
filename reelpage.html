<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Nistbook | Reels</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <style>
    :root {
      --golden: #ffd700;
      --blue: #1877f2;
      --bg: #f0f2f5;
      --card: #ffffff;
      --dark-bg: #18191a;
      --dark-card: #242526;
      --dark-text: #e4e6eb;
      --dark-border: #3a3b3c;
      --gray: #606770;
    }

    /* Base */
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background: var(--bg);
      color: var(--gray);
    }
    body.dark { background: var(--dark-bg); color: var(--dark-text); }

    /* Top nav */
    .top-nav {
      position: fixed; top: 0; left: 0; right: 0;
      height: 64px;
      background: var(--card);
      border-bottom: 1px solid #ddd;
      display: flex; align-items: center; justify-content: space-between;
      padding: 0 24px;
      z-index: 1000;
      box-shadow: 0 2px 12px rgba(0,0,0,0.08);
    }
    body.dark .top-nav { background: var(--dark-card); border-bottom: 1px solid var(--dark-border); }
    .logo { font-size: 28px; font-weight: 900; color: var(--golden); letter-spacing: .2px; }
    .nav-icons { display: flex; gap: 32px; }
    .nav-icons a { font-size: 22px; color: var(--gray); text-decoration: none; padding: 8px 10px; border-radius: 10px; }
    body.dark .nav-icons a { color: var(--dark-text); }
    .nav-icons a:hover, .nav-icons a.active { background: rgba(255,215,0,0.12); color: var(--golden); }
    .right-icons { display: flex; gap: 12px; }
    .icon-btn {
      width: 40px; height: 40px; border-radius: 50%;
      display: grid; place-items: center; background: var(--bg);
      color: inherit; cursor: pointer; transition: transform .15s ease, background .2s ease;
    }
    body.dark .icon-btn { background: #3a3b3c; color: var(--dark-text); }
    .icon-btn:hover { background: var(--golden); color: #000; transform: scale(1.08); }

    /* Center feed */
    .center-feed {
      margin-top: 64px;
      min-height: calc(100vh - 64px);
      padding: 20px;
      max-width: 680px;
      margin-left: auto;
      margin-right: auto;
    }

    /* Reels */
    .reel-card {
      position: relative;
      background: var(--card);
      border-radius: 14px;
      overflow: hidden;
      margin-bottom: 32px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.08);
      transition: transform .2s ease;
    }
    body.dark .reel-card { background: var(--dark-card); }
    .reel-card:hover { transform: translateY(-2px); }
    .reel-card video {
      width: 100%; height: 70vh; object-fit: cover; display: block; cursor: pointer;
      background: #000;
    }
    .reel-caption {
      position: absolute; bottom: 20px; left: 20px;
      color: #fff; font-size: 16px; font-weight: 600;
      text-shadow: 0 2px 6px rgba(0,0,0,0.6);
      max-width: 60ch;
    }
    .reel-actions {
      position: absolute; right: 20px; bottom: 20px;
      display: flex; flex-direction: column; gap: 12px;
    }
    .reel-actions button {
      width: 48px; height: 48px; border-radius: 50%;
      border: none; background: rgba(0,0,0,0.55); color: #fff;
      font-size: 18px; cursor: pointer; display: grid; place-items: center;
      transition: transform .15s ease, background .2s ease;
    }
    .reel-actions button:hover { background: var(--golden); color: #000; transform: scale(1.1); }
    .like.active { background: #ef4444; } /* red when liked */

    /* Small meta bar (author/time) */
    .meta {
      position: absolute; top: 14px; left: 14px;
      background: rgba(0,0,0,0.35);
      color: #fff; padding: 8px 12px; border-radius: 999px; font-size: 13px;
      backdrop-filter: blur(4px);
    }

    /* Modal fullscreen */
    .modal {
      position: fixed; inset: 0;
      background: rgba(0,0,0,0.85);
      display: none; align-items: center; justify-content: center;
      z-index: 2000;
    }
    .modal.active { display: flex; }
    .modal-content {
      position: relative; max-width: 92vw; max-height: 90vh;
    }
    .modal-content video { width: 100%; height: auto; border-radius: 12px; background: #000; }
    .modal-close {
      position: absolute; top: -48px; right: 0;
      font-size: 28px; color: #fff; cursor: pointer; user-select: none;
    }

    /* Helper */
    @media (max-width: 640px) {
      .center-feed { padding: 12px; max-width: 100%; }
      .reel-card video { height: 68vh; }
      .reel-caption { left: 14px; bottom: 16px; font-size: 15px; }
      .reel-actions { right: 14px; bottom: 16px; }
    }
  </style>
</head>
<body>

  <!-- Top nav -->
  <div class="top-nav">
    <div class="logo">Nistbook</div>
    <div class="nav-icons">
      <a href="Firstpage.html"><i class="fas fa-home"></i></a>
      <a href="reelpage.html" class="active"><i class="fas fa-play-circle"></i></a>
      <a href="grouppage.html"><i class="fas fa-users"></i></a>
      <a href="marketplacepage.html"><i class="fas fa-shopping-bag"></i></a>
      <a href="profilepage.html"><i class="fas fa-user"></i></a>
      <a href="settingpage.html"><i class="fas fa-cog"></i></a>
    </div>
    <div class="right-icons">
      <div class="icon-btn"><i class="fas fa-bell"></i></div>
      <div class="icon-btn"><i class="fas fa-comment-dots"></i></div>
      <div class="icon-btn" id="darkToggle" aria-label="Toggle dark mode"><i class="fas fa-moon"></i></div>
    </div>
  </div>

  <!-- Center feed (reels only) -->
  <main class="center-feed">

    <!-- Reel 1 -->
    <article class="reel-card">
      <span class="meta">Priya Thapa ‚Ä¢ 45m</span>
      <video src="physics-tip.mp4" muted playsinline preload="metadata"></video>
      <div class="reel-caption">Physics Tip: Interference patterns explained ‚ú®</div>
      <div class="reel-actions">
        <button class="like" title="Like">‚ù§</button>
        <button class="comment" title="Comment">üí¨</button>
        <button class="share" title="Share">‚§¥</button>
      </div>
    </article>

    <!-- Reel 2 -->
    <article class="reel-card">
      <span class="meta">Nistbook ‚Ä¢ 1h</span>
      <video src="exam-motivation.mp4" muted playsinline preload="metadata"></video>
      <div class="reel-caption">Exam Motivation: Focus beats panic üí™</div>
      <div class="reel-actions">
        <button class="like" title="Like">‚ù§</button>
        <button class="comment" title="Comment">üí¨</button>
        <button class="share" title="Share">‚§¥</button>
      </div>
    </article>

    <!-- Reel 3 -->
    <article class="reel-card">
      <span class="meta">Teacher Raj ‚Ä¢ Live demo</span>
      <video src="graphing-demo.mp4" muted playsinline preload="metadata"></video>
      <div class="reel-caption">Graphing Demo: SHM displacement vs time üìà</div>
      <div class="reel-actions">
        <button class="like" title="Like">‚ù§</button>
        <button class="comment" title="Comment">üí¨</button>
        <button class="share" title="Share">‚§¥</button>
      </div>
    </article>

  </main>

  <!-- Fullscreen modal -->
  <div class="modal" id="reelModal" aria-hidden="true">
    <div class="modal-content">
      <span class="modal-close" id="modalClose" aria-label="Close">&times;</span>
      <video id="modalVideo" controls></video>
    </div>
  </div>

  <script>
    // Dark mode toggle
    document.getElementById('darkToggle').addEventListener('click', function () {
      document.body.classList.toggle('dark');
      const icon = this.querySelector('i');
      icon.classList.toggle('fa-moon');
      icon.classList.toggle('fa-sun');
    });

    // Reels autoplay/pause when in viewport
    const feedVideos = document.querySelectorAll('.reel-card video');
    const io = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        const vid = entry.target;
        if (entry.isIntersecting) {
          vid.play().catch(() => {});
        } else {
          vid.pause();
        }
      });
    }, { threshold: 0.6 });
    feedVideos.forEach((v) => io.observe(v));

    // Like toggle
    document.querySelectorAll('.reel-actions .like').forEach((btn) => {
      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        btn.classList.toggle('active');
      });
    });

    // Modal logic
    const modal = document.getElementById('reelModal');
    const modalVideo = document.getElementById('modalVideo');
    const modalClose = document.getElementById('modalClose');

    // Open modal when clicking video
    feedVideos.forEach((video) => {
      video.addEventListener('click', () => {
        modal.classList.add('active');
        modal.setAttribute('aria-hidden', 'false');
        modalVideo.src = video.currentSrc || video.src;
        modalVideo.play().catch(() => {});
        document.body.style.overflow = 'hidden'; // prevent background scroll
      });
    });

    function closeModal() {
      modal.classList.remove('active');
      modal.setAttribute('aria-hidden', 'true');
      modalVideo.pause();
      modalVideo.removeAttribute('src'); // release source
      modalVideo.load(); // reset
      document.body.style.overflow = ''; // restore scroll
    }

    modalClose.addEventListener('click', closeModal);

    // Close on backdrop click (but not when clicking inside content)
    modal.addEventListener('click', (e) => {
      if (e.target === modal) closeModal();
    });

    // Close on Escape key
    window.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && modal.classList.contains('active')) {
        closeModal();
      }
    });

    // Optional: basic handlers for comment/share (placeholder alerts)
    document.querySelectorAll('.reel-actions .comment').forEach((btn) => {
      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        alert('Comments coming soon!');
      });
    });
    document.querySelectorAll('.reel-actions .share').forEach((btn) => {
      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        alert('Share options coming soon!');
      });
    });
  </script>
</body>
</html>
